---
title: "p8105_hw3_yo2336"
author: "Yoo Rim Oh"
output: github_document
---

```{r setup, include = FALSE}
library(tidyverse)
library(p8105.datasets)
```

# Problem 1

Load instacart data
```{r}
data("instacart")

range(pull(instacart, aisle_id))
count(instacart, aisle_id, aisle)

```

Aisle vs product plot
```{r}
aisle_df =
  instacart %>%
  count(aisle_id) %>%
  filter(n > 10000) %>%
  rename(number_ordered = n) %>%
  ggplot(aes(x = aisle_id, y = number_ordered)) +
  geom_point() +
  scale_x_continuous(
    breaks = c(0, 25, 50, 75, 100, 125))
  
```


Popular items per aisle
```{r}
bake_ingr_df =
  instacart %>%
  select(product_name, aisle) %>%
  filter(aisle == "baking ingredients") %>%
  count(aisle, product_name) %>%
  arrange(desc(n)) %>%
  head(3) %>%
  mutate(rank = c(1, 2, 3)) %>%
  pivot_wider(
    names_from = "aisle",
    values_from = "product_name"
  ) %>%
  relocate(rank, "baking ingredients")

dog_food_care_df = 
  instacart %>%
  select(product_name, aisle) %>%
  filter(aisle == "dog food care") %>%
  count(aisle, product_name) %>%
  arrange(desc(n)) %>%
  head(3) %>%
  mutate(rank = c(1, 2, 3)) %>%
  pivot_wider(
    names_from = "aisle",
    values_from = "product_name"
  ) %>%
  relocate(rank, "dog food care")

pack_veg_fruit_df = 
  instacart %>%
  select(product_name, aisle) %>%
  filter(aisle == "packaged vegetables fruits") %>%
  count(aisle, product_name) %>%
  arrange(desc(n)) %>%
  head(3) %>%
  mutate(rank = c(1, 2, 3)) %>%
  pivot_wider(
    names_from = "aisle",
    values_from = "product_name"
  ) %>%
  relocate(rank, "packaged vegetables fruits")

popular_table_df = 
  left_join(bake_ingr_df, left_join(dog_food_care_df, pack_veg_fruit_df, by = "rank"), 
            by = "rank") %>%
  janitor::clean_names() %>%
  rename(count_baking = n, count_dog = n_x, count_packaged = n_y)

knitr::kable(popular_table_df, caption = "Top 3 Products Ordered from Selected Aisles")
```


Mean hour per each day
```{r}

```


# Problem 2

Load BRFSS data
```{r}
data(brfss_smart2010)
```

